name: Student Management Workflow

on:
  push:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # Step 1: Checkout repository
    - name: Checkout repository
      uses: actions/checkout@v3

    # Step 2: Set up Python
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.10"

    # Step 3: Install dependencies
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # Step 4: Check code formatting with Black (exclude env folders)
    - name: Check code formatting with Black
      run: |
        pip install black
        black --check . --exclude 'myenv|venv|env'

    # Step 5: Lint code with flake8 (ignore warnings)
    - name: Lint code with flake8
      run: |
        pip install flake8
        flake8 . || echo "Lint warnings found (ignored)"

    # Step 6: Run unit tests (safe mode, no failure if none)
    - name: Run unit tests
      run: |
        pip install pytest
        echo "Running unit tests..."
        pytest || echo "No tests found"

    # Step 7: Simulate database setup or migrations
    - name: Simulate database setup
      run: |
        echo "Simulating database setup..."
        sleep 2
        echo "Database setup complete âœ…"

    # Step 8: Simulate build or deployment
    - name: Build and simulate deployment
      run: |
        echo "Building project..."
        sleep 3
        echo "Deployment simulation complete ðŸš€"
